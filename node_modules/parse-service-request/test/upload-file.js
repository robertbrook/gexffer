var fs = require('fs');

var stream = fs.createReadStream('./test/movie.avi', {
  'bufferSize': 8 * 1024
});
var totalChunks = 0;
var fileSize = 0;

/*
stream.on('data', function(chunk){
  totalChunks++;
  fileSize += chunk.length;
  console.log('total', totalChunks);
  console.log(chunk.length);
});
*/



stream.on('readable', function(){
  var chunk;
  while (null !== (chunk = stream.read(256 * 256 * 256))) {
    console.log('got %d bytes of data', chunk.length);
    totalChunks++;
    fileSize += chunk.length;
    console.log('total', totalChunks);
    console.log(chunk.length);
    
  }
  
});

//stream.read(4 * 1024);
//stream.resume()

stream.on('end', function(chunk){
  console.log('stream.end');
});

stream.on('error', function(chunk){
  console.log('stream.error');
});

stream.on('close', function(chunk){
  console.log('stream.close');
  console.log('total bytes streamed', fileSize);
})

//stream.pipe(process.stdout)